---
title: '[git]submoduleを使いこなそう'
description: 'git管理を切り分けたいそこのあなたに'
tags: ['Git']
image: 'img/header/how-to-use-git-submodule.png'
createdAt: '2020-08-12'
---

近年のwebサービスだと、フロントとバックで別サーバーになっていたりすることが多いと思います。

大きなサービスになってくると、そこにバッチサーバーが入ったり、アカウント管理だけ切り出して…とか。

マイクロサービス化的な話かと思いますが、サービス自体はシンプルになる一方インフラはどんどん複雑になってきますよね。

そんな昨今、手放せないスキルであるgitのsubmoduleについて今回はご紹介します。

-------

<!--more-->

## ことばの紹介

まずは知らない方もいるかと思うので、ことばの紹介から。

わかってるよ！って人は飛ばしてください。

-------

### submoduleとは

[git-scmのサイト](https://git-scm.com/book/ja/v2/Git-%E3%81%AE%E3%81%95%E3%81%BE%E3%81%96%E3%81%BE%E3%81%AA%E3%83%84%E3%83%BC%E3%83%AB-%E3%82%B5%E3%83%96%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB)から引用します。

> サブモジュールを使うと、ある Git リポジトリを別の Git リポジトリのサブディレクトリとして扱うことができるようになります。

> これで、別のリポジトリをプロジェクト内にクローンしても自分のコミットは別管理とすることができるようになります。

ということで、Git管理している1部分を切り出して管理できる仕組みのようなイメージですね。

Rubyだと、gemにしちゃえばいいじゃん！となるかもしれませんが、それはそれで大変なので…

gem化するほどじゃないけど、他のプロジェクトでもこの部分使いたい！とかなったときに使う形です。

-------

## 使ってみましょう

それでは早速使っていきましょう。

今回は、こんな感じのプロジェクトを切り分けてみたいと思います。

現状はapp直下でのみgit管理しているものを、front、backそれぞれsubmodule化して切り出していこうと思います。

```

app
|
├-- front
|
└-- back

```

作業手順としては

1. それぞれをmasterとしてgit管理を開始

2. 新しくapp_02を作成

3. app_02にsubmoduleとしてfront、backを取り込み

という手順でいこうと思います。

-------

### それぞれをmasterとしてgit管理を開始

はい。やってください。

-------

### 新しくapp_02を作成

これもいい感じにやってください。

-------

### app_02にsubmoduleとしてfront、backを取り込み

さあ、ここからですね。

app_02の直下で下記を実行してください。

```
git submodule add <frontのGitHubURL> front

git submodule add <backのGitHubURL> back
```

これで、app_02内にfront、backそれぞれディレクトリができていると思います。

その後、例えばfrontを修正した際は下記手順でgitの管理をしてください。

1. frontでgitの変更を記録

2. appでsubmoduleの更新

これでプロジェクトを切り出して管理できますね。

今日はこのあたりで。

-------

## 参考にした記事

- [Git - サブモジュール](https://git-scm.com/book/ja/v2/Git-%E3%81%AE%E3%81%95%E3%81%BE%E3%81%96%E3%81%BE%E3%81%AA%E3%83%84%E3%83%BC%E3%83%AB-%E3%82%B5%E3%83%96%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB)から引用します。
